
FRA_the_next_revolution = {

	communist_uprising = {
		icon = revolt
		allowed = { tag = FRA }
		available = { 
			has_country_flag = FRA_communist_uprising_avoided
		}
		activation = { 
			has_country_flag = FRA_communist_uprising	
			NOT = {
				has_country_flag = FRA_communist_civil_war_begun
			}		 
		}
		cancel_trigger = {
			hidden_trigger = {			
				OR = {	
					has_country_flag = FRA_communist_uprising_avoided
					has_government = communism	
					has_civil_war = yes
					is_subject = yes		
				}
			}
		}
		is_good = no
		fire_only_once = yes
		days_mission_timeout = 470
		timeout_effect = {
			custom_effect_tooltip = FRA_communist_uprising_start
			if = {
				limit = {
					has_equipment = {
						infantry_equipment < 10
					}
				}
				add_equipment_to_stockpile = {		##avoid republicains to fight with no guns
					type = infantry_equipment
					amount = 10000
				}
			}
			country_event = ww1_france.5
		}
	}

	three_side_uprising = {
		icon = revolt
		allowed = { tag = FRA }
		available = { 
			NOT = {
				has_country_flag = FRA_three_side_civil_war_trigger
			}
		}
		activation = {
			tag = FRA 
			has_country_flag = FRA_three_side_civil_war_trigger	
			NOT = {
				has_country_flag = FRA_three_side_civil_war
				has_global_flag = FRA_three_side_civil_war
			}		 
		}
		cancel_trigger = {
			OR = {
				NOT = {
					has_country_flag = FRA_three_side_civil_war_trigger	
				}
				has_country_flag = FRA_three_side_civil_war
				has_global_flag = FRA_three_side_civil_war
			}
		}
		is_good = no
		fire_only_once = yes
		days_mission_timeout = 90
		timeout_effect = {
			custom_effect_tooltip = FRA_communist_uprising_start
			country_event = ww1_france.319
		}
	}

	trigger_civil_war = {
		allowed = { tag = FRA }
		available = {
		}
		visible = {
			is_debug = yes
		}
		complete_effect = {
			custom_effect_tooltip = FRA_communist_uprising_start
			country_event = ww1_france.5
		}
	}

	clear_all_resistance = {
		allowed = {
			original_tag = FRA
		}
		available = {
			original_tag = FRA
		}
		visible = {
			original_tag = FRA
			is_debug = yes
		}
		fixed_random_seed = no
		fire_only_once = no
		cost = 0
		icon = generic_nationalism
		complete_effect = {
			every_state = {
				limit = {
					is_core_of = FRA
				}
				clr_state_flag = communard_presence
			}
		}
	}

	automatic_add_resistance = {
		icon = revolt
		allowed = { tag = FRA }
		available = {
			has_country_flag = FRA_communist_uprising_avoided
		}
		activation = { 
			has_country_flag = FRA_fight_the_communists_title
			has_country_flag = great_war_loser
			NOT = {
				has_country_flag = FRA_communist_uprising_avoided
				has_country_flag = FRA_communist_civil_war_begun
			}	  
		}
		is_good = no
		days_mission_timeout = 35
		timeout_effect = {
			if = {
				limit = { 
					16 = {
						has_state_flag = communard_presence
					}
				}
				random_owned_controlled_state = {
					limit = {
						is_core_of = ROOT
						is_on_continent = europe
						NOT = {
							has_state_flag = communard_presence
						}
						any_neighbor_state = {
							has_state_flag = communard_presence
						}
					}
					set_state_flag = communard_presence
					custom_effect_tooltip = FRA_state_join_socialists
				}
				else = {
					16 = {
						set_state_flag = communard_presence
					}
				}
			}
		}
	}

	automatic_event_spawner = {
		allowed = { tag = FRA }
		available = {
			has_country_flag = FRA_communist_uprising_avoided
		}
		activation = { 
			has_country_flag = FRA_fight_the_communists_title
			has_country_flag = great_war_loser
			NOT = {
				has_country_flag = FRA_communist_uprising_avoided
				has_country_flag = FRA_communist_civil_war_begun
			}
		}
		is_good = no
		days_mission_timeout = 14
		days_re_enable = 50
		timeout_effect = {
			random_list = {
				25 = {
					#strip 1000 guns from national reserves
					country_event = ww1_france.52
				}
				25 = {
					#add 5% socialism support
					country_event = ww1_france.53
				}
				25 = {
					#a random state gain a communist sympathies but not a "neighbourg state"
					country_event = ww1_france.53
				}
				25 = {
					#remove 30 days to civil war timeout
					country_event = ww1_france.54
				}
			}
		}
	}

	add_resistance_to_random_french_state = {
		icon = revolt
		allowed = {
			original_tag = FRA
		}
		available = {
			original_tag = FRA
		}
		visible = {
			original_tag = FRA
			is_debug = yes
		}
		fixed_random_seed = no
		fire_only_once = no
		cost = 0
		complete_effect = {
			if = {
				limit = { 
					16 = {
						has_state_flag = communard_presence
					}
				}
				random_owned_controlled_state = {
					limit = {
						is_core_of = ROOT
						is_on_continent = europe
						NOT = {
							has_state_flag = communard_presence
						}
						any_neighbor_state = {
							has_state_flag = communard_presence
						}
					}
					set_state_flag = communard_presence
				}
				else = {
					16 = {
						set_state_flag = communard_presence
					}
				}
			}
		}
	}

	spawn_communard_divisions = {
		allowed = {
			original_tag = FRA
		}
		available = {
			original_tag = FRA
		}
		visible = {
			original_tag = FRA
			is_debug = yes
		}
		fixed_random_seed = no
		fire_only_once = yes
		cost = 0

		complete_effect = {
			division_template = {
				name = "Troupe de communards"
				priority = -1
				regiments = { 
					infantry = {
						x = 0
						y = 0
					}
					infantry = {
						x = 0
						y = 1
					}
					infantry = {
						x = 0
						y = 2
					}
				}
			}

			every_state = {
				limit = { has_state_flag = communard_presence }
				create_unit = {
					division = "division_template = \"Troupe de communards\" start_experience_factor = 0.1 start_equipment_factor = 0.75"
					owner = ROOT
				}
				create_unit = {
					division = "division_template = \"Troupe de communards\" start_experience_factor = 0.1 start_equipment_factor = 0.75"
					owner = ROOT
				}
				create_unit = {
					division = "division_template = \"Troupe de communards\" start_experience_factor = 0.1 start_equipment_factor = 0.75"
					owner = ROOT
				}
			}
		}
	}

	FRA_repression_to_state = {
		allowed = {
			original_tag = FRA
		}
		available = {
			has_country_flag = great_war_loser
			has_country_flag = FRA_fight_the_communists_title # from focus
			original_tag = FRA
			NOT = {
				has_government = communism
				has_country_flag = FRA_is_fighting_communist
			}
			14 = {
				has_state_flag = communard_presence
			}
		}
		visible = {
			has_country_flag = great_war_loser
			has_country_flag = FRA_fight_the_communists_title # from focus
			original_tag = FRA
			NOT = {
				has_government = communism
			}
			FROM = {
				has_state_flag = communard_presence
			}
		}
		state_target = yes
		target_array = FRA.core_states
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
			}
		}
		fixed_random_seed = no
		cost = 0
		days_re_enable = 30
		days_remove = 35
		fire_only_once = no
		
		ai_will_do = {
			factor = 1000
		}
		icon = generic_nationalism
		on_map_mode = map_and_decisions_view

		highlight_states = {
			highlight_state_targets = { state = FROM } 
			highlight_color_while_active = 1
		}
		complete_effect = {
			set_country_flag = FRA_is_fighting_communist
		}
		remove_effect = {
			FROM = {
				clr_state_flag = communard_presence
			}
		}
	}
}

FRA_keep_guard_over_the_versailles_system = {
	FRA_chastise_german_declaration_of_war = {
		icon = GFX_decision_generic_ignite_civil_war
		allowed = {
			tag = FRA
		}
		available = {
			has_capitulated = no
			GER = {
				is_neighbor_of = PREV
				has_capitulated = no
				OR = {
					is_faction_leader = yes
					is_in_faction = no
				}
				any_other_country = {
					has_defensive_war_with = PREV
					is_constituent_of_germany = no
				}
			}
			NOT = {
				has_idea = idea_army_restrictions
				has_wargoal_against = GER
			}
		}
		visible = {
			has_global_flag = interbellum
			has_country_flag = great_war_winner
			is_subject = no
			GER = {
				has_country_flag = great_war_loser
				is_subject = no
				NOT = {
					is_in_faction_with = PREV
					has_war_with = PREV
				}
			}
		}
		target_trigger = {
			FROM = { tag = GER }
		}
		fire_only_once = yes
		cost = 250
		ai_will_do = {
			factor = 1000
			modifier = {
				factor = 0
				has_war_support < 0.5
			}
			modifier = {
				factor = 0
				has_stability < 0.5
			}
			modifier = {
				factor = 0
				threat < 0.2
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = GER
					ratio < 1.5
				}
			}
		}
		days_remove = 45
		war_with_on_remove = GER
		complete_effect = {
			add_stability = -0.1
			add_named_threat = {
				threat = 10
				name = FRA_chastise_german_declaration_of_war
			}
		}
		remove_effect = {
			declare_war_on = {
				target = GER
				type = topple_government
			}
			news_event = ww1_germany.132
		}
	}
	FRA_occupy_ruhr = {
		icon = GFX_decision_generic_ignite_civil_war
		allowed = {
			tag = FRA
		}
		available = {
			has_capitulated = no
			has_war = no
			has_country_flag = great_war_winner
			OR = {
				GER = {
					controls_state = 873
					is_neighbor_of = PREV
				}
				HAN = {
					controls_state = 873
					is_neighbor_of = PREV
				}
			}
			GER = {
				has_capitulated = no
				has_country_flag = great_war_loser
			}
			has_country_flag = can_occupy_ruhr
		}
		visible = {
			has_country_flag = great_war_winner
			has_country_flag = can_occupy_ruhr
		}
		target_trigger = {
			FROM = { tag = GER }
		}
		fire_only_once = yes
		cost = 0
		ai_will_do = {
			factor = 1000
			modifier = {
				factor = 0
				has_stability < 0.2
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = GER
					ratio < 1.0
				}
			}
			modifier = {
				factor = 0
				GER = {
					has_government = neutrality
					has_country_flag = kapp_putsch
					NOT = { has_country_flag = kapp_civil_war }
				}
			}
		}
		days_remove = 10
		war_with_on_remove = GER
		complete_effect = {
			add_manpower = -1000
			add_named_threat = {
				threat = 2
				name = FRA_ruhr_occupation
			}
		}
		remove_effect = {
			transfer_state = 873
			add_ideas = FRA_ruhr_occupation
			set_global_flag = ruhr_occupation
			news_event = ww1_germany.135
			ENG = {
				add_opinion_modifier = {
					target = FROM
					modifier = medium_decrease
				}
			}
			random_country = {
				limit = {
					owns_state = 793
				}
				transfer_state = 51
				add_ideas = FRA_ruhr_occupation
			}
			GER = {
				country_event = {
					id = ww1_germany.136
					days = 7
				}
				country_event = {
					id = ww1_germany.138
					days = 20
				}
			}
		}
	}
	FRA_withdraw_from_ruhr = {
		icon = GFX_decision_generic_ignite_civil_war
		allowed = {
			tag = FRA
		}
		available = {
			has_capitulated = no
			has_war = no
			GER = {
				is_neighbor_of = PREV
				has_capitulated = no
				has_war = no
			}
		}
		visible = {
			has_global_flag = interbellum
			has_country_flag = great_war_winner
			is_subject = no
			owns_state = 873
			GER = {
				has_country_flag = great_war_loser
				is_subject = no
				owns_state = 57
			}
		}
		target_trigger = {
			FROM = { tag = GER }
		}
		fire_only_once = yes
		cost = 0
		ai_will_do = {
			factor = 1000
			modifier = {
				factor = 0
				NOT = { has_subject = GER }
				OR = {
					AND = {
						PREV = { NOT = { has_government = communism } }
						has_government = communism
					}
					AND = {
						has_government = fascism
						NOT = { has_country_leader_ideology = nazism }
					}
					has_country_leader_ideology = autocracy
					has_country_leader_ideology = semi_constitutional_monarchy
				}
			}
			modifier = {
				factor = 0
				GER = { has_idea = GER_idea_default }
			}
			modifier = {
				factor = 0
				date < 1925.5.5
			}
		}
		complete_effect = {
			country_event = ww1_germany.139
		}
	}
	FRA_separate_germany_from_austria = {
		icon = GFX_decision_generic_ignite_civil_war
		allowed = {
			original_tag = FRA
		}
		available = {
			has_war = no
			NOT = {
				has_idea = idea_army_restrictions
				has_wargoal_against = GER
			}
			FROM = {
				has_war = no
				is_subject = no
				is_neighbor_of = PREV
			}
		}
		visible = {
			has_global_flag = interbellum
			has_country_flag = great_war_winner
			FROM = {
				has_country_flag = great_war_loser
				OR = {
					owns_state = 4
					has_subject = AUS
					has_subject = AUH
				}
			}
			is_subject = no
			AUH = {
				has_country_flag = great_war_loser
			}
		}
		target_trigger = {
			FROM = {
				tag = GER
			}
		}
		fire_only_once = yes
		cost = 250
		ai_will_do = {
			factor = 1000
			modifier = {
				factor = 0
				has_war_support < 0.5
			}
			modifier = {
				factor = 0
				has_stability < 0.5
			}
			modifier = {
				factor = 0
				threat < 0.2
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = GER
					ratio < 1.5
				}
			}
		}
		days_remove = 45
		war_with_on_remove = GER
		complete_effect = {
			add_stability = -0.1
			add_named_threat = {
				threat = 10
				name = FRA_separate_germany_from_austria
			}
		}
		remove_effect = {
			declare_war_on = {
				target = GER
				type = topple_government
			}
			news_event = ww1_germany.132
		}
	}
	FRA_occupy_baden_wurttemberg = {
		icon = GFX_decision_generic_ignite_civil_war
		allowed = {
			tag = FRA
		}
		available = {
			has_capitulated = no
			has_war = no
			GER = {
				is_neighbor_of = PREV
				has_capitulated = no
				controls_state = 50
				OR = {
					is_faction_leader = yes
					is_in_faction = no
				}
				OR = {
					AND = {
						PREV = { NOT = { has_government = communism } }
						has_government = communism
					}
					has_government = fascism
					has_country_leader_ideology = autocracy
					has_country_leader_ideology = semi_constitutional_monarchy
				}
			}
			NOT = {
				has_idea = idea_army_restrictions
				has_wargoal_against = GER
			}
		}
		visible = {
			has_global_flag = interbellum
			has_country_flag = great_war_winner
			is_subject = no
			owns_state = 28
			GER = {
				has_country_flag = great_war_loser
				is_subject = no
				NOT = {
					is_in_faction_with = PREV
				}
				owns_state = 50
			}
			NOT = {
				has_global_flag = prussian_blue
				country_exists = WUR
			}
		}
		target_trigger = {
			FROM = { tag = GER }
		}
		fire_only_once = yes
		cost = 100
		ai_will_do = {
			factor = 1000
			modifier = {
				factor = 0
				has_war_support < 0.3
			}
			modifier = {
				factor = 0
				has_stability < 0.4
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = GER
					ratio < 1.0
				}
			}
			modifier = {
				factor = 0
				GER = {
					has_government = neutrality
					has_country_flag = kapp_putsch
					NOT = { has_country_flag = kapp_civil_war }
				}
			}
			modifier = {
				factor = 0
				GER = {
					has_government = fascism
					has_country_leader_ideology = nazism
				}
			}
		}
		days_remove = 10
		war_with_on_remove = GER
		complete_effect = {
			add_manpower = -1000
			add_named_threat = {
				threat = 5
				name = ww1_germany.145.t
			}
		}
		remove_effect = {
			GER = { country_event = ww1_germany.145 }
		}
	}
	FRA_balkanise_germany = {
		icon = revolt
		allowed = {
			tag = FRA
		}
		available = {
			has_war = no
			GER = { has_war = no }
		}
		visible = {
			has_global_flag = interbellum
			has_country_flag = great_war_winner
			is_subject = no
			NOT = {
				has_government = democratic
				has_government = communism
				country_exists = PRE
			}
			GER = {
				is_subject_of = PREV
				NOT = {
					has_cosmetic_tag = PRE
				}
				any_owned_state = {
					OR = {
						state = 5
						state = 60
						state = 62
						state = 63
						state = 64
						state = 66
						state = 67
						state = 85
						state = 86
						state = 188
						state = 404
						state = 762
						state = 763
					}
				}
			}
			NOT = {
				has_global_flag = prussian_blue
				country_exists = WUR
			}
		}
		target_trigger = {
			FROM = { tag = GER }
		}
		fire_only_once = no
		cost = 250
		ai_will_do = {
			base = 0
			modifier = {
				add = 1000
				has_government = neutrality
				NOT = { has_country_leader_ideology = authoritarian_democracy }
			}
			modifier = {
				add = 1000
				has_government = fascism
				NOT = { has_country_leader_ideology = stratocracy }
			}
		}
		days_remove = 180
		cancel_if_not_visible = yes
		cancel_effect = {
			add_political_power = 100
		}
		remove_effect = {
			country_event = ww1_germany.127
		}
	}

}

FRA_GER_intervention_in_France = {
	
	FRA_german_intervention_trigger = {
		icon = revolt
		allowed = {
			always = yes
		}
		fire_only_once = yes
		visible = {
			tag = FRA
			is_in_faction_with = GER
		}
		available = {
			16 = {
				OWNER = {
					has_war = no
				}
			} 
			tag = FRA
			ROOT = {
				is_in_faction_with = GER
			}
			OR = {
				FRC = {
					exists = yes
				}
				NFA = {
					exists = yes
				}
			}
		}
		ai_will_do = {
			factor = 150
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		days_remove = 14
		complete_effect = {
			set_global_flag = FRA_GER_intervention_button_pushed
		}
		remove_effect = {
			declare_war_on = {
				target = 16.OWNER
				type = civil_war
			}
			GER = {
				declare_war_on = {
					target = 16.OWNER
					type = topple_government
				}
			}
			hidden_effect = {
				declare_war_on = {
					target = FRC
					type = civil_war
				}
				GER = {
					declare_war_on = {
						target = FRC
						type = topple_government
					}
				}
				declare_war_on = {
					target = NFA
					type = civil_war
				}
				GER = {
					declare_war_on = {
						target = NFA
						type = topple_government
					}
				}
			}
		}
	}

	GER_surrender_to_hostical_FRA = {
		icon = revolt
		allowed = {
			tag = GER
		}
		fire_only_once = yes
		visible = {
			tag = GER
			has_global_flag = FRA_GER_intervention_button_pushed
		}
		available = { 
			tag = GER
			surrender_progress > 0.1
			OR = {
				has_war_with = FRC
				has_war_with = NFA
			}
		}
		ai_will_do = {
			factor = 0
			modifier = {
				surrender_progress > 0.15
				factor = 150
			}
		}
		days_remove = 3
		complete_effect = {
			clr_global_flag = FRA_GER_intervention_button_pushed
			set_global_flag = GER_surrender_to_FRC_NFA
		}
		remove_effect = {
			every_country = {
				limit = {
					is_in_faction_with = GER
				}
				every_owned_state = {
					limit = {
						OR = {
							is_claimed_by = 16.OWNER
							is_core_of = 16.OWNER
						}
					}
					transfer_state_to = 16.OWNER
				}
				white_peace = 16.OWNER
			}
			
		}
	}

	FRA_german_intervention_timeout = {
		icon = revolt
		allowed = {
			always = yes
		}
		available = { 
			FRC = {
				exists = no
			}
			NFA = {
				exists = no
			}
			FRA = {
				exists = yes
			}
		}
		activation = {
			GER = {
				OR = {
					has_war_with = NFA
					has_war_with = FRC
				}
			}	 
			FRA = {
				OR = {
					is_subject_of = GER
					is_in_faction_with = GER
				}
			}
		}
		cancel_trigger = {
			GER = {
				has_war = no
			}
		}
		is_good = no
		fire_only_once = yes
		days_mission_timeout = 280
		timeout_effect = {
			every_country = {
				limit = {
					OR = {
						original_tag = FRA
						tag = GER
						has_war_with = FRC
						has_war_with = NFA
					}
				}
				country_event = {
					id = ww1_france.330
					days = 1
				}
			}
		}
	}
}